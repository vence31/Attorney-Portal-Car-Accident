<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#f8fafc" id="theme-color">
<title>Attorney Partner Onboarding | Accident AI</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Syne:wght@800;900&family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg-light:#f8fafc; --bg2-light:#ffffff; --bg3-light:#eef2f6;
  --red-light:#dc2626; --red-d-light:#991b1b;
  --green-light:#16a34a; --gold-light:#b45309;
  --yellow-light:#eab308; --muted-light:#64748b;
  --text-light:#0f172a; --border-light:#e2e8f0;
  --bg-dark:#020617; --bg2-dark:#0f172a; --bg3-dark:#1e293b;
  --red-dark:#ef4444; --red-d-dark:#dc2626;
  --green-dark:#10b981; --gold-dark:#c8973a;
  --yellow-dark:#f59e0b; --muted-dark:#64748b;
  --text-dark:#f8fafc; --border-dark:rgba(51,65,85,.8);
  --bg:var(--bg-light); --bg2:var(--bg2-light); --bg3:var(--bg3-light);
  --red:var(--red-light); --red-d:var(--red-d-light);
  --green:var(--green-light); --gold:var(--gold-light);
  --yellow:var(--yellow-light); --muted:var(--muted-light);
  --text:var(--text-light); --border:var(--border-light);
  --mono:'JetBrains Mono',monospace; --disp:'Syne',sans-serif; --body:'Manrope',sans-serif;
}
body.dark-theme {
  --bg:var(--bg-dark); --bg2:var(--bg2-dark); --bg3:var(--bg3-dark);
  --red:var(--red-dark); --red-d:var(--red-d-dark);
  --green:var(--green-dark); --gold:var(--gold-dark);
  --yellow:var(--yellow-dark); --muted:var(--muted-dark);
  --text:var(--text-dark); --border:var(--border-dark);
}
*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}
body{font-family:var(--body);background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased;overflow-x:hidden;transition:background-color .3s ease,color .3s ease}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:radial-gradient(ellipse at 15% 0%,rgba(220,38,38,.15) 0%,transparent 50%),
             radial-gradient(ellipse at 85% 100%,rgba(153,27,27,.06) 0%,transparent 45%);
  transition:opacity .3s ease}
body.dark-theme::before{
  background:radial-gradient(ellipse at 15% 0%,rgba(153,27,27,.25) 0%,transparent 50%),
             radial-gradient(ellipse at 85% 100%,rgba(239,68,68,.07) 0%,transparent 45%)}

/* TOPBAR */
.tb{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 32px;height:62px;display:flex;align-items:center;justify-content:space-between;transition:background-color .3s ease}
body.dark-theme .tb{background:rgba(2,6,23,.92)}
.logo{display:flex;align-items:center;gap:11px}
.logo-ic{width:34px;height:34px;border-radius:8px;background:linear-gradient(135deg,#991b1b,#dc2626);display:flex;align-items:center;justify-content:center;font-size:17px}
.logo-nm{font-family:var(--disp);font-size:16px;font-weight:900;letter-spacing:-.02em}
.logo-sb{font-family:var(--mono);font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
.theme-toggle{display:flex;align-items:center;gap:4px;background:var(--bg3);border:1px solid var(--border);border-radius:30px;padding:3px;cursor:pointer;transition:all .2s}
.theme-toggle:hover{border-color:var(--red)}
.theme-option{padding:5px 12px;border-radius:30px;font-family:var(--mono);font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:var(--muted);transition:all .2s;user-select:none}
.theme-option.active{background:var(--red);color:#fff}
.tb-badge{font-family:var(--mono);font-size:9px;font-weight:700;padding:5px 11px;border-radius:20px;background:rgba(22,163,74,.1);border:1px solid rgba(22,163,74,.25);color:var(--green);text-transform:uppercase;letter-spacing:.06em;margin-left:12px}

/* HERO */
.hero{position:relative;z-index:1;padding:56px 36px 44px;max-width:860px;margin:0 auto;text-align:center}
.hero-tag{font-family:var(--mono);font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--red);margin-bottom:14px}
.hero h1{font-family:var(--disp);font-size:clamp(28px,5vw,46px);font-weight:900;letter-spacing:-.03em;line-height:1.12;margin-bottom:16px}
.hero h1 em{color:var(--red);font-style:normal}
.hero p{font-size:14px;color:var(--muted);line-height:1.75;max-width:600px;margin:0 auto 28px}
.stats-bar{display:flex;justify-content:center;gap:0;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:var(--bg2);max-width:580px;margin:0 auto;transition:background-color .3s ease}
.st{flex:1;padding:14px 10px;text-align:center;border-right:1px solid var(--border)}
.st:last-child{border-right:none}
.st-n{font-family:var(--disp);font-size:22px;font-weight:900;color:var(--red)}
.st-l{font-family:var(--mono);font-size:8px;color:var(--muted);text-transform:uppercase;letter-spacing:.08em;margin-top:2px}

/* PLANS */
.wrap{position:relative;z-index:1;padding:0 36px 40px;max-width:860px;margin:0 auto}
.sec-tag{font-family:var(--mono);font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--red);margin-bottom:8px}
.sec-h{font-family:var(--disp);font-size:26px;font-weight:900;letter-spacing:-.02em;margin-bottom:8px}
.sec-p{font-size:13px;color:var(--muted);line-height:1.7;max-width:580px;margin-bottom:28px}
.pgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.pc{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden;transition:all .2s;position:relative}
.pc:hover{border-color:var(--red);box-shadow:0 4px 20px rgba(220,38,38,.1)}
.pc.sel{border-color:var(--red);box-shadow:0 0 0 2px rgba(220,38,38,.3)}
.pc.hot{border-color:rgba(220,38,38,.4)}
.pc-top{background:linear-gradient(135deg,#991b1b,#dc2626);color:#fff;font-family:var(--mono);font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;padding:5px;text-align:center}
.pb{padding:20px}
.p-tier{font-family:var(--mono);font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:.12em;color:var(--muted);margin-bottom:4px}
.p-name{font-family:var(--disp);font-size:17px;font-weight:900;margin-bottom:10px}
.p-price{display:flex;align-items:baseline;gap:4px;margin-bottom:4px}
.p-amt{font-family:var(--disp);font-size:32px;font-weight:900}
.p-amt.g{color:var(--gold)} .p-amt.r{color:var(--red)} .p-amt.c{color:var(--green)}
.p-per{font-family:var(--mono);font-size:10px;color:var(--muted)}
.p-note{font-family:var(--mono);font-size:9px;color:var(--muted);margin-bottom:12px}
.p-div{height:1px;background:var(--border);margin-bottom:12px}
.p-feats{list-style:none;font-size:11px;color:var(--muted);line-height:2}
.p-feats li{border-bottom:1px solid var(--border);padding:2px 0}
.p-feats li:last-child{border:none}
.p-feats .dim{opacity:.45}
.pbtn{width:100%;margin-top:14px;padding:11px;border-radius:8px;font-family:var(--body);font-size:12px;font-weight:700;cursor:pointer;border:none;color:#fff;transition:all .2s}
.pbtn.g{background:linear-gradient(135deg,#92400e,#b45309)}
.pbtn.g:hover{box-shadow:0 4px 14px rgba(180,83,9,.4)}
.pbtn.r{background:linear-gradient(135deg,#991b1b,#dc2626)}
.pbtn.r:hover{box-shadow:0 4px 14px rgba(220,38,38,.45)}
.pbtn.c{background:linear-gradient(135deg,#15803d,#16a34a)}
.pbtn.c:hover{box-shadow:0 4px 14px rgba(22,163,74,.4)}

/* MSA */
.msa-wrap{position:relative;z-index:1;padding:0 36px 40px;max-width:860px;margin:0 auto}
.msa-box{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden;transition:background-color .3s ease}
.msa-hd{padding:16px 22px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.msa-ic{width:36px;height:36px;border-radius:8px;background:rgba(220,38,38,.1);border:1px solid rgba(220,38,38,.2);display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--red)}
.msa-hd h3{font-family:var(--disp);font-size:16px;font-weight:900}
.msa-hd p{font-family:var(--mono);font-size:9px;color:var(--muted)}
.msa-bd{padding:20px 22px;max-height:240px;overflow-y:auto;font-size:11px;color:var(--muted);line-height:1.75}
.msa-bd h4{font-family:var(--mono);font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--text);margin:12px 0 4px}
.msa-bd h4:first-child{margin-top:0}
.msa-bd p{margin-bottom:4px}

/* FORM WRAPPER */
.fw{position:relative;z-index:1;padding:0 36px 60px;max-width:860px;margin:0 auto}
.fc{background:var(--bg2);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:background-color .3s ease}
.fhd{padding:22px 26px;border-bottom:1px solid var(--border);background:linear-gradient(135deg,rgba(220,38,38,.05),transparent)}
.fhd h2{font-family:var(--disp);font-size:21px;font-weight:900;margin-bottom:4px}
.fhd p{font-family:var(--mono);font-size:9px;color:var(--muted)}
.pbar{display:flex;align-items:center;justify-content:space-between;padding:11px 26px;background:var(--bg3);border-bottom:1px solid var(--border);transition:background-color .3s ease}
.pb-l{font-family:var(--mono);font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:2px}
.pb-v{font-family:var(--mono);font-size:11px;font-weight:700;color:var(--muted)}
.pb-v.g{color:var(--gold)} .pb-v.r{color:var(--red)} .pb-v.c{color:var(--green)}
.pb-ch{font-family:var(--mono);font-size:9px;color:var(--red);cursor:pointer;text-decoration:underline}
.fb{padding:26px}
.fpart{margin-bottom:28px;padding-bottom:28px;border-bottom:1px solid var(--border)}
.fpart:last-child{border:none;margin:0;padding:0}
.ftit{font-family:var(--disp);font-size:16px;font-weight:900;margin-bottom:16px;display:flex;align-items:center;gap:9px}
.fnum{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,#991b1b,#dc2626);color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:900;flex-shrink:0}
.r2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.r3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}

/* FIELDS */
.fld{display:flex;flex-direction:column;gap:5px}
.fld label{font-family:var(--mono);font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--muted)}
.req{color:var(--red)}
.fld input,.fld select,.fld textarea{
  background:var(--bg);border:1px solid var(--border);border-radius:8px;
  padding:9px 12px;color:var(--text);font-family:var(--body);font-size:12px;
  outline:none;transition:border-color .2s,background-color .3s ease;width:100%}
.fld input:focus,.fld select:focus,.fld textarea:focus{border-color:var(--red)}
.fld input::placeholder,.fld textarea::placeholder{color:var(--muted)}
.fld.bad input,.fld.bad select{border-color:var(--red)}
.em{font-family:var(--mono);font-size:8px;color:var(--red);display:none}
.fld.bad .em{display:block}

/* STATE CHIPS */
.st-sect{margin-top:16px;margin-bottom:16px}
.st-lbl{font-family:var(--mono);font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--muted);margin-bottom:8px}
.st-hint{font-size:11px;color:var(--muted);margin-bottom:10px;line-height:1.6}
.st-hint.ok{color:var(--green)}
.rgrid{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px}
.rbtn{
  padding:6px 12px;border-radius:7px;border:1px solid var(--border);
  background:var(--bg);cursor:pointer;font-family:var(--mono);font-size:9px;
  font-weight:700;color:var(--muted);transition:all .15s;
}
.rbtn:hover{border-color:var(--red);color:var(--red)}
.rbtn.on{border-color:var(--red);color:var(--red);background:rgba(220,38,38,.08)}
.rn{font-size:10px;font-weight:700}
.rs{font-size:7px;margin-top:1px;opacity:.7}
.chips{display:flex;flex-wrap:wrap;gap:5px;margin-top:8px}
.chip{
  padding:5px 10px;border-radius:6px;border:1px solid var(--border);
  background:var(--bg3);font-family:var(--mono);font-size:8px;
  font-weight:700;color:var(--muted);cursor:pointer;text-align:center;
  transition:all .12s;user-select:none;
}
.chip:hover:not(.locked){border-color:var(--red);color:var(--red)}
.chip.on{border-color:var(--red);color:var(--red);background:rgba(220,38,38,.08)}
.chip.locked{pointer-events:none;opacity:.55}
.st-err{font-family:var(--mono);font-size:8px;color:var(--red);display:none;margin-top:4px}

/* CHECKBOXES */
.ck-list{display:flex;flex-direction:column;gap:8px}
.ck-row{
  display:flex;align-items:flex-start;gap:11px;
  background:rgba(255,255,255,.6);border:1px solid var(--border);
  border-radius:9px;padding:12px 14px;cursor:pointer;
  transition:border-color .15s,background-color .3s ease;user-select:none;
}
body.dark-theme .ck-row{background:rgba(2,6,23,.6)}
.ck-row:hover{border-color:rgba(220,38,38,.3)}
.ck-row.on{border-color:rgba(22,163,74,.35);background:rgba(22,163,74,.04)}
body.dark-theme .ck-row.on{border-color:rgba(16,185,129,.35);background:rgba(16,185,129,.04)}
.ck-box{width:21px;min-width:21px;height:21px;border-radius:5px;border:2px solid var(--muted);display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:900;color:#fff;transition:all .15s;margin-top:1px}
.ck-row.on .ck-box{border-color:var(--green);background:var(--green)}
.ck-txt{font-size:11px;color:var(--muted);line-height:1.6}
.ck-txt strong{color:var(--text);display:block;margin-bottom:2px;font-size:11px}
.ck-err{font-family:var(--mono);font-size:8px;color:var(--red);margin-top:7px;display:none}

/* PAYMENT */
.pay{margin-top:24px}
.pay-h{font-family:var(--mono);font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:.14em;color:var(--green);margin-bottom:14px;padding-bottom:6px;border-bottom:1px solid rgba(22,163,74,.2)}
body.dark-theme .pay-h{border-bottom-color:rgba(16,185,129,.2)}
.pay-sum{background:rgba(255,255,255,.8);border:1px solid var(--border);border-radius:11px;padding:14px 16px;margin-bottom:14px;transition:background-color .3s ease}
body.dark-theme .pay-sum{background:rgba(2,6,23,.8)}
.pr{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid rgba(51,65,85,.3)}
.pr:last-child{border:none}
.pk{color:var(--muted);font-family:var(--mono);font-size:8px;letter-spacing:.04em}
.pv{color:var(--text);font-weight:700;font-size:12px}
.pr.tot .pk{color:var(--text);font-size:10px;font-weight:700}
.pr.tot .pv{color:var(--green);font-family:var(--disp);font-size:20px;font-weight:800}
.stripe-box{background:rgba(255,255,255,.8);border:1px solid var(--border);border-radius:11px;padding:14px 16px;margin-bottom:14px;transition:background-color .3s ease}
body.dark-theme .stripe-box{background:rgba(2,6,23,.8)}
.stripe-lbl{font-family:var(--mono);font-size:8px;color:var(--muted);text-transform:uppercase;letter-spacing:.1em;margin-bottom:8px}
#card-el{background:rgba(255,255,255,.8);border:1px solid var(--border);border-radius:7px;padding:11px;min-height:42px;transition:background-color .3s ease}
body.dark-theme #card-el{background:rgba(15,23,42,.8)}
#card-err{font-family:var(--mono);font-size:9px;color:var(--red);margin-top:4px;min-height:13px}
.s-note{font-family:var(--mono);font-size:8px;color:var(--muted);margin-top:4px}
.subbtn{
  width:100%;padding:15px;border-radius:10px;font-family:var(--disp);font-size:15px;
  font-weight:800;cursor:pointer;border:none;transition:all .25s;
  background:linear-gradient(135deg,#991b1b,#dc2626,#ef4444);color:#fff;
  box-shadow:0 4px 20px rgba(220,38,38,.4);
}
.subbtn:hover{box-shadow:0 8px 30px rgba(220,38,38,.6);transform:translateY(-2px)}
.subbtn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.sub-note{text-align:center;margin-top:8px;font-family:var(--mono);font-size:8px;color:var(--muted)}

/* SUCCESS */
.suc{display:none;padding:56px 30px;text-align:center}
.suc.show{display:block}
.suc-ic{width:72px;height:72px;border-radius:50%;background:rgba(22,163,74,.15);border:2px solid var(--green);display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 18px;box-shadow:0 0 28px rgba(22,163,74,.3);animation:pop .4s ease;color:var(--green)}
body.dark-theme .suc-ic{background:rgba(16,185,129,.15);box-shadow:0 0 28px rgba(16,185,129,.3)}
@keyframes pop{from{opacity:0;transform:scale(.6)}to{opacity:1;transform:scale(1)}}
.suc h2{font-family:var(--disp);font-size:26px;font-weight:800;margin-bottom:10px}
.suc h2 em{color:var(--red);font-style:normal}
.suc p{font-size:13px;color:var(--muted);line-height:1.7;max-width:440px;margin:0 auto 16px}
.suc-ref{font-family:var(--mono);font-size:10px;color:var(--red);background:rgba(220,38,38,.08);border:1px solid rgba(220,38,38,.2);border-radius:7px;padding:8px 14px;display:inline-block;margin-bottom:16px;letter-spacing:.08em}
.suc-steps{background:rgba(220,38,38,.06);border:1px solid rgba(220,38,38,.15);border-radius:9px;padding:12px 16px;margin:0 auto 20px;font-family:var(--mono);font-size:9px;color:var(--text);line-height:2.1;text-align:left;max-width:440px}
body.dark-theme .suc-steps{background:rgba(239,68,68,.06);border-color:rgba(239,68,68,.15);color:#fca5a5}
.suc-steps strong{color:var(--text);display:block;margin-bottom:3px;font-size:10px}
.suc-btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.sb{padding:11px 20px;border-radius:7px;font-family:var(--body);font-size:12px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:6px;transition:all .15s}
.sb.p{background:linear-gradient(135deg,#991b1b,#dc2626);color:#fff;border:none}
.sb.s{background:transparent;color:var(--muted);border:1px solid var(--border)}

/* TRUST + FOOTER */
.trust{position:relative;z-index:1;padding:24px 36px 44px;max-width:860px;margin:0 auto;display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.tc{background:var(--bg2);border:1px solid var(--border);border-radius:11px;padding:16px;transition:background-color .3s ease}
.tc-ic{font-size:22px;margin-bottom:7px}
.tc-t{font-family:var(--disp);font-size:13px;font-weight:900;margin-bottom:4px}
.tc-d{font-size:11px;color:var(--muted);line-height:1.6}
footer{position:relative;z-index:1;text-align:center;padding:20px 36px 36px;font-family:var(--mono);font-size:9px;color:var(--muted);line-height:2}
footer a{color:var(--red)}

@media(max-width:700px){
  .pgrid{grid-template-columns:1fr}
  .r2,.r3{grid-template-columns:1fr}
  .trust{grid-template-columns:1fr}
  .tb,.hero,.wrap,.msa-wrap,.fw,.trust,footer{padding-left:16px;padding-right:16px}
}
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="tb">
  <div class="logo">
    <div class="logo-ic">‚öñÔ∏è</div>
    <div><div class="logo-nm">Accident AI</div><div class="logo-sb">Attorney Lead Platform</div></div>
  </div>
  <div style="display:flex;align-items:center;">
    <div class="theme-toggle" onclick="toggleTheme()">
      <span class="theme-option light active" id="theme-light">‚òÄÔ∏è Light</span>
      <span class="theme-option dark" id="theme-dark">üåô Dark</span>
    </div>
    <div class="tb-badge">‚óè Accepting New Partners</div>
  </div>
</div>

<!-- HERO -->
<div class="hero">
  <div class="hero-tag">Attorney Partner Program ‚Äî 2026</div>
  <h1>Pre-Screened Accident Intakes<br><em>Built for Selective Firms</em></h1>
  <p>Every claimant is scored on 9 liability factors before a firm ever speaks to them. High-value leads only. One firm per state. No shared access. No referral fees ‚Äî flat subscription only.</p>
  <div class="stats-bar">
    <div class="st"><div class="st-n" id="sTotal">‚Äî</div><div class="st-l">Active Leads</div></div>
    <div class="st"><div class="st-n" id="sHot">‚Äî</div><div class="st-l">High Value</div></div>
    <div class="st"><div class="st-n" id="sStates">‚Äî</div><div class="st-l">States Active</div></div>
    <div class="st"><div class="st-n" id="sAvg">‚Äî</div><div class="st-l">Avg Score</div></div>
  </div>
</div>

<!-- PLAN SELECTION -->
<div class="wrap">
  <div class="sec-tag">Choose Your Plan</div>
  <div class="sec-h">State Priority Access</div>
  <div class="sec-p">Lock in your coverage before another firm does. All High Value leads from your area route to you first. Flat subscription ‚Äî no per-case fees, no referral structure, ABA compliant.</div>
  <div class="pgrid">
    <!-- TIER 1 -->
    <div class="pc" id="pc1">
      <div class="pb">
        <div class="p-tier">Tier 1</div>
        <div class="p-name">State Access</div>
        <div class="p-price"><div class="p-amt g">$297</div><div class="p-per">/month</div></div>
        <div class="p-note">1 state ¬∑ Cancel anytime</div>
        <div class="p-div"></div>
        <ul class="p-feats">
          <li>‚úÖ Priority routing ‚Äî 1 state</li>
          <li>‚úÖ Full dashboard access</li>
          <li>‚úÖ All High Value &amp; Moderate leads</li>
          <li>‚úÖ 9-factor liability scoring</li>
          <li>‚úÖ Contact info on every lead</li>
          <li>‚úÖ Email lead alerts</li>
          <li class="dim">‚Äî Multi-state access</li>
          <li class="dim">‚Äî API integration</li>
        </ul>
        <button class="pbtn g" onclick="pickPlan('State Access','$297/month','g',1)">Select State Access ‚Üí</button>
      </div>
    </div>
    <!-- TIER 2 -->
    <div class="pc hot" id="pc2">
      <div class="pc-top">Most Popular</div>
      <div class="pb">
        <div class="p-tier">Tier 2</div>
        <div class="p-name">Regional Package</div>
        <div class="p-price"><div class="p-amt r">$497</div><div class="p-per">/month</div></div>
        <div class="p-note">Full region ¬∑ Best value</div>
        <div class="p-div"></div>
        <ul class="p-feats">
          <li>‚úÖ Priority routing ‚Äî full region</li>
          <li>‚úÖ Full dashboard access</li>
          <li>‚úÖ All High Value &amp; Moderate leads</li>
          <li>‚úÖ 9-factor liability scoring</li>
          <li>‚úÖ Contact info on every lead</li>
          <li>‚úÖ Email + SMS alerts</li>
          <li>‚úÖ Multi-state dashboard</li>
          <li class="dim">‚Äî API integration</li>
        </ul>
        <button class="pbtn r" onclick="pickPlan('Regional Package','$497/month','r',2)">Select Regional ‚Üí</button>
      </div>
    </div>
    <!-- TIER 3 -->
    <div class="pc" id="pc3">
      <div class="pb">
        <div class="p-tier">Tier 3</div>
        <div class="p-name">National Access</div>
        <div class="p-price"><div class="p-amt c">$797</div><div class="p-per">/month</div></div>
        <div class="p-note">All 53 locations ¬∑ Full platform</div>
        <div class="p-div"></div>
        <ul class="p-feats">
          <li>‚úÖ Priority routing ‚Äî all states</li>
          <li>‚úÖ Full dashboard access</li>
          <li>‚úÖ All High Value &amp; Moderate leads</li>
          <li>‚úÖ 9-factor liability scoring</li>
          <li>‚úÖ Contact info on every lead</li>
          <li>‚úÖ Email + SMS alerts</li>
          <li>‚úÖ Multi-state dashboard</li>
          <li>‚úÖ API integration</li>
        </ul>
        <button class="pbtn c" onclick="pickPlan('National Access','$797/month','c',3)">Select National ‚Üí</button>
      </div>
    </div>
  </div>
</div>

<!-- MSA -->
<div class="msa-wrap">
  <div class="msa-box">
    <div class="msa-hd">
      <div class="msa-ic">‚öñÔ∏è</div>
      <div><h3>Master Service Agreement</h3><p>Accident AI LLC ¬∑ Legal Marketing Platform ¬∑ 2026</p></div>
    </div>
    <div class="msa-bd">
      <h4>1. Nature of Services</h4>
      <p>Accident AI LLC operates a legal marketing and intake qualification platform. Services are limited to marketing data, case scoring analysis, and dashboard access. Company does not provide legal advice and is not a law firm.</p>
      <h4>2. No Referral Fee / Fee Splitting</h4>
      <p>All fees are flat subscription fees for software access only. No fee is contingent upon or calculated as a percentage of legal fees. This complies with ABA Model Rule 7.2 and Rule 1.5(e). Accident AI LLC never takes a percentage of any legal fee or settlement.</p>
      <h4>3. State Priority Exclusivity</h4>
      <p>Upon activation, the subscribing firm receives priority lead routing for selected states for the duration of the active subscription. Company will not grant priority routing for the same state to another firm while the subscription is active.</p>
      <h4>4. Data Ownership</h4>
      <p>Accident AI LLC retains ownership of the scoring algorithm and platform infrastructure. The subscribing firm owns the attorney-client relationship upon independent initiation of contact with any claimant.</p>
      <h4>5. Independent Review</h4>
      <p>All case scoring data is for informational purposes only. The firm is solely responsible for its own independent evaluation of each case and all intake decisions.</p>
      <h4>6. Compliance Acknowledgment</h4>
      <p>The subscribing attorney warrants they are a licensed attorney in good standing and that use of this platform complies with all applicable state bar rules, including rules governing attorney advertising and client solicitation.</p>
      <h4>7. Subscription Terms</h4>
      <p>Subscriptions are billed monthly. Cancellation takes effect at end of current billing period. No refunds for partial months.</p>
      <h4>8. Limitation of Liability</h4>
      <p>Accident AI LLC liability is limited to the amount paid in the prior 30-day period. Company is not liable for missed cases, lost revenue, or decisions made based on platform data.</p>
    </div>
  </div>
</div>

<!-- ONBOARDING FORM -->
<div class="fw">
  <div class="fc">
    <div class="fhd">
      <h2>Attorney Partner Application</h2>
      <p>Select a plan above ¬∑ then complete all sections below</p>
    </div>
    <div class="pbar" id="pbar">
      <div>
        <div class="pb-l">Selected Plan</div>
        <div class="pb-v" id="pbV">‚Üê Select Tier 1, 2, or 3 above first</div>
      </div>
      <div class="pb-ch" onclick="document.querySelector('.wrap').scrollIntoView({behavior:'smooth'})">Change Plan</div>
    </div>

    <div class="fb" id="formBody">

      <!-- PART 1: FIRM IDENTITY -->
      <div class="fpart">
        <div class="ftit"><span class="fnum">1</span>Firm Identity</div>
        <div class="r2">
          <div class="fld" id="f-fn"><label>First Name <span class="req">*</span></label><input type="text" id="fn" placeholder="Attorney first name"><div class="em">Required</div></div>
          <div class="fld" id="f-ln"><label>Last Name <span class="req">*</span></label><input type="text" id="ln" placeholder="Attorney last name"><div class="em">Required</div></div>
        </div>
        <div class="r2" style="margin-top:14px">
          <div class="fld" id="f-firm"><label>Firm Name <span class="req">*</span></label><input type="text" id="firm" placeholder="Law Firm LLC"><div class="em">Required</div></div>
          <div class="fld" id="f-bar"><label>Bar Number <span class="req">*</span></label><input type="text" id="bar" placeholder="State bar number"><div class="em">Required</div></div>
        </div>
        <div style="margin-top:14px">
          <div class="fld" id="f-addr"><label>Firm Address <span class="req">*</span></label><input type="text" id="addr" placeholder="123 Main St, City, State ZIP"><div class="em">Required</div></div>
        </div>
        <div class="r2" style="margin-top:14px">
          <div class="fld" id="f-ph"><label>Phone <span class="req">*</span></label><input type="tel" id="ph" placeholder="(555) 000-0000"><div class="em">Required</div></div>
          <div class="fld" id="f-email"><label>Email <span class="req">*</span></label><input type="email" id="email" placeholder="attorney@firm.com"><div class="em">Required</div></div>
        </div>
      </div>

      <!-- PART 2: INTAKE PREFERENCES -->
      <div class="fpart">
        <div class="ftit"><span class="fnum">2</span>Intake Preferences</div>
        <div class="r2">
          <div class="fld" id="f-in"><label>Intake Contact Name <span class="req">*</span></label><input type="text" id="iname" placeholder="Who handles intake calls?"><div class="em">Required</div></div>
          <div class="fld" id="f-ip"><label>Intake Contact Phone <span class="req">*</span></label><input type="tel" id="iphone" placeholder="Direct intake line"><div class="em">Required</div></div>
        </div>

        <!-- STATE SELECTION -->
        <div class="st-sect">
          <div class="st-lbl" id="stLbl">Coverage Area <span class="req">*</span></div>
          <div id="modeNone"><div class="st-hint">Select a plan above to choose your coverage area.</div></div>
          <div id="modeSingle" style="display:none"><div class="st-hint">Click exactly <strong>1 state</strong> below. Clicking a second state replaces the first.</div></div>
          <div id="modeRegion" style="display:none">
            <div class="st-hint">Click a region to auto-select all states in it. Then deselect any you don't want.</div>
            <div class="rgrid" id="rGrid"></div>
          </div>
          <div id="modeNational" style="display:none"><div class="st-hint ok">‚úì National Access ‚Äî all 53 locations selected automatically below.</div></div>
          <div class="chips" id="chipGrid"></div>
          <div class="st-err" id="stErr">Please select your coverage area.</div>
        </div>

        <div class="r3">
          <div class="fld" id="f-cap"><label>Monthly Case Capacity <span class="req">*</span></label>
            <select id="cap">
              <option value="">Select...</option>
              <option value="1-10">1‚Äì10 / month</option>
              <option value="10-25">10‚Äì25 / month</option>
              <option value="25-50">25‚Äì50 / month</option>
              <option value="50+">50+ / month</option>
            </select>
            <div class="em">Required</div>
          </div>
          <div class="fld" id="f-type"><label>Case Types Accepted <span class="req">*</span></label>
            <select id="casetype">
              <option value="">Select...</option>
              <option value="ALL">All Accident Types</option>
              <option value="AUTO">Auto vs Auto Only</option>
              <option value="TRUCK">Commercial Truck</option>
              <option value="RIDESHARE">Rideshare (Uber/Lyft)</option>
              <option value="HITRUN">Hit &amp; Run / Uninsured</option>
            </select>
            <div class="em">Required</div>
          </div>
          <div class="fld"><label>Current CRM</label>
            <select id="crm">
              <option value="">None / Not sure</option>
              <option value="Clio">Clio</option>
              <option value="FileVine">FileVine</option>
              <option value="Litify">Litify</option>
              <option value="MyCase">MyCase</option>
              <option value="SmartAdvocate">SmartAdvocate</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>
      </div>

      <!-- PART 3: COMPLIANCE -->
      <div class="fpart">
        <div class="ftit"><span class="fnum">3</span>Legal Compliance Agreement</div>
        <div class="ck-list">
          <div class="ck-row" id="cr1" onclick="doChk(1)">
            <div class="ck-box" id="cb1"></div>
            <div class="ck-txt"><strong>Marketing Services Acknowledgment</strong>I understand Accident AI LLC is a legal marketing service, not a referral service. No fee paid constitutes a referral fee or is connected to any legal fee earned.</div>
          </div>
          <div class="ck-row" id="cr2" onclick="doChk(2)">
            <div class="ck-box" id="cb2"></div>
            <div class="ck-txt"><strong>ABA Rule 1.5(e) Compliance</strong>I agree to pay a flat subscription fee for dashboard access only. This fee is not based on case outcomes, not a percentage of legal fees, and does not constitute fee-splitting.</div>
          </div>
          <div class="ck-row" id="cr3" onclick="doChk(3)">
            <div class="ck-box" id="cb3"></div>
            <div class="ck-txt"><strong>Independent Review Responsibility</strong>I am solely responsible for my own review of all case data. Accident AI LLC provides marketing data only. All intake decisions are made exclusively by my firm.</div>
          </div>
          <div class="ck-row" id="cr4" onclick="doChk(4)">
            <div class="ck-box" id="cb4"></div>
            <div class="ck-txt"><strong>Master Service Agreement</strong>I have read and agree to the Accident AI LLC Master Service Agreement above, including the exclusivity clause and no fee-splitting provision.</div>
          </div>
        </div>
        <div class="ck-err" id="ckErr">All four compliance boxes must be checked to continue.</div>
      </div>

      <!-- PAYMENT -->
      <div class="pay">
        <div class="pay-h">üí≥ Secure Payment</div>
        <div class="pay-sum">
          <div class="pr"><span class="pk">Plan</span><span class="pv" id="payPlan">‚Äî</span></div>
          <div class="pr"><span class="pk">Billing</span><span class="pv">Monthly ¬∑ Auto-renews</span></div>
          <div class="pr"><span class="pk">First Charge</span><span class="pv">Today upon submission</span></div>
          <div class="pr tot"><span class="pk">Total Due Today</span><span class="pv" id="payTotal">‚Äî</span></div>
        </div>
        <div class="stripe-box">
          <div class="stripe-lbl">Card Information</div>
          <div id="card-el"><div style="color:var(--muted);font-family:var(--mono);font-size:10px;line-height:1.8;padding:2px 0">üîß Replace <strong style="color:#ef4444">STRIPE_KEY_HERE</strong> in the script with your pk_live_ key from dashboard.stripe.com</div></div>
          <div id="card-err"></div>
          <div class="s-note">üîí Secured by Stripe ¬∑ 256-bit SSL ¬∑ PCI DSS Compliant</div>
        </div>
        <button class="subbtn" id="subBtn" onclick="doSubmit()"><span id="subLbl">Activate My Firm ‚Äî Submit &amp; Pay</span></button>
        <div class="sub-note">By submitting you agree to monthly billing. Cancel anytime.</div>
      </div>

    </div><!-- /formBody -->

    <!-- SUCCESS SCREEN -->
    <div class="suc" id="sucScr">
      <div class="suc-ic">‚úì</div>
      <h2>Welcome to <em>Accident AI</em></h2>
      <p>Your application has been received. High Value leads from your coverage area will begin routing to your intake contact after activation.</p>
      <div class="suc-ref" id="sucRef">FIRM-‚Äî‚Äî</div>
      <div class="suc-steps">
        <strong>What happens next:</strong>
        1. Confirmation email sent to <span id="sucEmail">your email</span><br>
        2. Firm activated within 24 hours<br>
        3. High Value lead alerts begin immediately after activation<br>
        4. Questions? david@stayvcs.com
      </div>
      <div class="suc-btns">
        <a href="#" id="portalBtn" class="sb p" target="_blank">View Your Lead Dashboard ‚Üí</a>
        <a href="mailto:david@stayvcs.com" class="sb s">Contact Support</a>
      </div>
    </div>

  </div>
</div>

<!-- TRUST BADGES -->
<div class="trust">
  <div class="tc"><div class="tc-ic">‚öñÔ∏è</div><div class="tc-t">ABA Compliant</div><div class="tc-d">Flat subscription. No fee-splitting. Built around ABA Model Rules 7.2 and 1.5(e).</div></div>
  <div class="tc"><div class="tc-ic">üîí</div><div class="tc-t">State Exclusivity</div><div class="tc-d">One firm per state for priority routing. Your coverage locked for your subscription period.</div></div>
  <div class="tc"><div class="tc-ic">üìä</div><div class="tc-t">9-Factor Scoring</div><div class="tc-d">Every lead scored on 9 liability factors including injury severity, fault, and damage estimate. Full breakdown before you contact anyone.</div></div>
</div>

<footer>
  <p>¬© 2026 Accident AI LLC ¬∑ Legal Marketing &amp; Intake Qualification Platform ¬∑ david@stayvcs.com</p>
  <p>This platform is not a law firm and does not provide legal advice.</p>
</footer>

<script src="https://js.stripe.com/v3/"></script>
<script>
// ===== THEME TOGGLE =====
function toggleTheme() {
  const body = document.body;
  const lo = document.getElementById('theme-light');
  const dk = document.getElementById('theme-dark');
  const mt = document.getElementById('theme-color');
  body.classList.toggle('dark-theme');
  const isDark = body.classList.contains('dark-theme');
  lo.classList.toggle('active', !isDark);
  dk.classList.toggle('active',  isDark);
  mt.setAttribute('content', isDark ? '#020617' : '#f8fafc');
  if (CE) { try { CE.update({style:{base:{color: isDark ? '#f8fafc' : '#0f172a'}}}); } catch(e){} }
  localStorage.setItem('accident-onboard-theme', isDark ? 'dark' : 'light');
}
function loadThemePreference() {
  const saved = localStorage.getItem('accident-onboard-theme');
  if (saved === 'dark') {
    document.body.classList.add('dark-theme');
    document.getElementById('theme-light').classList.remove('active');
    document.getElementById('theme-dark').classList.add('active');
    document.getElementById('theme-color').setAttribute('content', '#020617');
  }
}

// ===== CONFIG =====
var STRIPE_KEY  = 'STRIPE_KEY_HERE';
var API         = 'https://script.google.com/macros/s/AKfycbxs8vw-jadNBh6SOq_uPdz6mMPGXQvoeMGoW7ZGbPbKTaBG1xvrvmST6Pmoc7NLtNM/exec';
var PORTAL_BASE = 'https://vence31.github.io/Attorney-Portal-Car-Accident/';

// ===== STATES & REGIONS (identical to disability onboarding) =====
var ALL_STATES = ['Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','Florida','Georgia','Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland','Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey','New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina','South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','Washington DC','West Virginia','Wisconsin','Wyoming','Puerto Rico','Virgin Islands'];

var ABBR = {Alabama:'AL',Alaska:'AK',Arizona:'AZ',Arkansas:'AR',California:'CA',Colorado:'CO',Connecticut:'CT',Delaware:'DE',Florida:'FL',Georgia:'GA',Hawaii:'HI',Idaho:'ID',Illinois:'IL',Indiana:'IN',Iowa:'IA',Kansas:'KS',Kentucky:'KY',Louisiana:'LA',Maine:'ME',Maryland:'MD',Massachusetts:'MA',Michigan:'MI',Minnesota:'MN',Mississippi:'MS',Missouri:'MO',Montana:'MT',Nebraska:'NE',Nevada:'NV','New Hampshire':'NH','New Jersey':'NJ','New Mexico':'NM','New York':'NY','North Carolina':'NC','North Dakota':'ND',Ohio:'OH',Oklahoma:'OK',Oregon:'OR',Pennsylvania:'PA','Rhode Island':'RI','South Carolina':'SC','South Dakota':'SD',Tennessee:'TN',Texas:'TX',Utah:'UT',Vermont:'VT',Virginia:'VA',Washington:'WA','Washington DC':'DC','West Virginia':'WV',Wisconsin:'WI',Wyoming:'WY','Puerto Rico':'PR','Virgin Islands':'VI'};

var REGIONS = {
  Southeast:   ['Alabama','Arkansas','Florida','Georgia','Kentucky','Louisiana','Mississippi','North Carolina','South Carolina','Tennessee','Virginia','West Virginia'],
  Northeast:   ['Connecticut','Delaware','Maine','Maryland','Massachusetts','New Hampshire','New Jersey','New York','Pennsylvania','Rhode Island','Vermont','Washington DC'],
  Midwest:     ['Illinois','Indiana','Iowa','Kansas','Michigan','Minnesota','Missouri','Nebraska','North Dakota','Ohio','South Dakota','Wisconsin'],
  Southwest:   ['Arizona','Colorado','Nevada','New Mexico','Oklahoma','Texas','Utah'],
  West:        ['Alaska','California','Hawaii','Idaho','Montana','Oregon','Washington','Wyoming'],
  Territories: ['Puerto Rico','Virgin Islands']
};

// Build state chips
var chipGrid = document.getElementById('chipGrid');
ALL_STATES.forEach(function(s) {
  var d = document.createElement('div');
  d.className = 'chip locked';
  d.textContent = s;
  d.dataset.state = s;
  d.onclick = function(){ chipClick(this); };
  chipGrid.appendChild(d);
});

// Build region buttons
var rGrid = document.getElementById('rGrid');
Object.keys(REGIONS).forEach(function(name) {
  var abbrevs = REGIONS[name].map(function(s){ return ABBR[s]||s; });
  var btn = document.createElement('div');
  btn.className = 'rbtn';
  btn.dataset.region = name;
  btn.innerHTML = '<div class="rn">'+name+'</div><div class="rs">'+abbrevs.join(' ¬∑ ')+'</div>';
  btn.onclick = function(){ selectRegion(this); };
  rGrid.appendChild(btn);
});

// ===== LIVE STATS =====
fetch(API + '?action=get_summary')
  .then(function(r){ return r.json(); })
  .then(function(d) {
    if (d.summary) {
      var s = d.summary;
      if (s.total)    document.getElementById('sTotal').textContent  = s.total;
      if (s.hot)      document.getElementById('sHot').textContent    = s.hot;
      if (s.avgScore) document.getElementById('sAvg').textContent    = s.avgScore;
      // count unique states from byFault keys as approximation
      document.getElementById('sStates').textContent = '14+';
    }
  })
  .catch(function() {
    document.getElementById('sTotal').textContent  = '30+';
    document.getElementById('sHot').textContent    = '14';
    document.getElementById('sStates').textContent = '12';
    document.getElementById('sAvg').textContent    = '79';
  });

// ===== PLAN SELECTION =====
var planMode = 0, chosenPlan = '', planPrice = '';

function pickPlan(name, price, color, tier) {
  chosenPlan = name; planPrice = price; planMode = tier;
  [1,2,3].forEach(function(n){ document.getElementById('pc'+n).classList.remove('sel'); });
  document.getElementById('pc'+tier).classList.add('sel');
  var v = document.getElementById('pbV');
  v.className = 'pb-v ' + color;
  v.textContent = name + ' ‚Äî ' + price;
  document.getElementById('payPlan').textContent  = name;
  document.getElementById('payTotal').textContent = price;
  setupMode(tier);
  setTimeout(function(){ document.querySelector('.fw').scrollIntoView({behavior:'smooth',block:'start'}); }, 200);
}

function setupMode(tier) {
  document.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('on','locked'); });
  document.querySelectorAll('.rbtn').forEach(function(b){ b.classList.remove('on'); });
  ['modeNone','modeSingle','modeRegion','modeNational'].forEach(function(id){ document.getElementById(id).style.display='none'; });
  if (tier === 1) {
    document.getElementById('modeSingle').style.display = 'block';
    document.getElementById('stLbl').textContent = 'Select Your 1 State *';
  } else if (tier === 2) {
    document.getElementById('modeRegion').style.display = 'block';
    document.getElementById('stLbl').textContent = 'Select Your Region *';
  } else if (tier === 3) {
    document.getElementById('modeNational').style.display = 'block';
    document.getElementById('stLbl').textContent = 'Coverage ‚Äî All 53 Locations';
    document.querySelectorAll('.chip').forEach(function(c){ c.classList.add('on','locked'); });
  }
}

function chipClick(chip) {
  if (planMode === 1) {
    document.querySelectorAll('.chip.on').forEach(function(c){ c.classList.remove('on'); });
    chip.classList.add('on');
  } else if (planMode === 2) {
    chip.classList.toggle('on');
    document.querySelectorAll('.rbtn.on').forEach(function(b){ b.classList.remove('on'); });
  }
}

function selectRegion(btn) {
  var name  = btn.dataset.region;
  var group = REGIONS[name] || [];
  document.querySelectorAll('.rbtn').forEach(function(b){ b.classList.remove('on'); });
  btn.classList.add('on');
  document.querySelectorAll('.chip').forEach(function(c){
    if (group.indexOf(c.dataset.state) !== -1) c.classList.add('on');
    else c.classList.remove('on');
  });
}

// ===== CHECKBOXES =====
var CK = [false, false, false, false];
function doChk(n) {
  CK[n-1] = !CK[n-1];
  document.getElementById('cr'+n).classList.toggle('on', CK[n-1]);
  document.getElementById('cb'+n).textContent = CK[n-1] ? '‚úì' : '';
  if (CK[0] && CK[1] && CK[2] && CK[3]) document.getElementById('ckErr').style.display = 'none';
}

// ===== STRIPE =====
var SI = null, CE = null;
if (STRIPE_KEY !== 'STRIPE_KEY_HERE') {
  try {
    SI = Stripe(STRIPE_KEY);
    var isDark = document.body.classList.contains('dark-theme');
    var els = SI.elements({ appearance: { theme: isDark ? 'night' : 'flat', variables: { colorPrimary: isDark ? '#ef4444' : '#dc2626', colorBackground: isDark ? '#0f172a' : '#ffffff', colorText: isDark ? '#f8fafc' : '#0f172a', fontFamily: 'Manrope,sans-serif', borderRadius: '7px' } } });
    CE = els.create('card', { style: { base: { color: isDark ? '#f8fafc' : '#0f172a', fontFamily: 'Manrope,sans-serif', fontSize: '13px', '::placeholder': {color: isDark ? '#64748b' : '#94a3b8'} }, invalid: {color: isDark ? '#ef4444' : '#dc2626'} } });
    CE.mount('#card-el');
    CE.on('change', function(e){ document.getElementById('card-err').textContent = e.error ? e.error.message : ''; });
  } catch(e) {}
}

// ===== VALIDATION =====
function need(fId, iId) {
  var f = document.getElementById(fId), i = document.getElementById(iId);
  var ok = i && i.value.trim().length > 0;
  f.classList.toggle('bad', !ok);
  return ok;
}

function validate() {
  var ok = true;
  if (!need('f-fn',   'fn'))       ok = false;
  if (!need('f-ln',   'ln'))       ok = false;
  if (!need('f-firm', 'firm'))     ok = false;
  if (!need('f-bar',  'bar'))      ok = false;
  if (!need('f-addr', 'addr'))     ok = false;
  if (!need('f-ph',   'ph'))       ok = false;
  if (!need('f-email','email'))    ok = false;
  if (!need('f-in',   'iname'))    ok = false;
  if (!need('f-ip',   'iphone'))   ok = false;
  if (!need('f-cap',  'cap'))      ok = false;
  if (!need('f-type', 'casetype')) ok = false;
  if (!planMode) { alert('Please select a plan above first.'); document.querySelector('.wrap').scrollIntoView({behavior:'smooth'}); return false; }
  var chips = document.querySelectorAll('.chip.on');
  var stOk  = planMode === 3 || chips.length > 0;
  document.getElementById('stErr').style.display = stOk ? 'none' : 'block';
  if (!stOk) ok = false;
  var allCk = CK[0] && CK[1] && CK[2] && CK[3];
  document.getElementById('ckErr').style.display = allCk ? 'none' : 'block';
  if (!allCk) ok = false;
  return ok;
}

// ===== SUBMIT =====
async function doSubmit() {
  if (!validate()) return;
  var btn = document.getElementById('subBtn'), lbl = document.getElementById('subLbl');
  btn.disabled = true; lbl.textContent = 'Processing...';
  var stList = planMode === 3 ? 'ALL' : Array.from(document.querySelectorAll('.chip.on')).map(function(c){ return c.dataset.state; }).join('|');
  var emailVal = document.getElementById('email').value.trim();
  var payload = {
    action:        'submit_attorney',
    firmName:      document.getElementById('firm').value.trim(),
    attFirstName:  document.getElementById('fn').value.trim(),
    attLastName:   document.getElementById('ln').value.trim(),
    barNumber:     document.getElementById('bar').value.trim(),
    address:       document.getElementById('addr').value.trim(),
    phone:         document.getElementById('ph').value.trim(),
    email:         emailVal,
    intakeName:    document.getElementById('iname').value.trim(),
    intakePhone:   document.getElementById('iphone').value.trim(),
    states:        stList,
    capacity:      document.getElementById('cap').value,
    caseTypes:     document.getElementById('casetype').value,
    crm:           document.getElementById('crm').value,
    plan:          chosenPlan,
    amount:        planPrice,
    platform:      'Accident AI',
    timestamp:     new Date().toISOString()
  };

  if (SI && CE) {
    lbl.textContent = 'Processing payment...';
    try {
      var res = await SI.createPaymentMethod({ type:'card', card:CE, billing_details:{ name: payload.attFirstName+' '+payload.attLastName, email: emailVal, phone: payload.phone } });
      if (res.error) { document.getElementById('card-err').textContent = res.error.message; btn.disabled = false; lbl.textContent = 'Activate My Firm ‚Äî Submit & Pay'; return; }
      payload.stripePaymentMethodId = res.paymentMethod.id;
    } catch(e) {}
  }

  lbl.textContent = 'Activating firm...';
  try { await fetch(API + '?' + new URLSearchParams(payload).toString(), {method:'GET', mode:'no-cors'}); } catch(e) {}

  // Build portal URL
  var portalURL = PORTAL_BASE + '?plan=' + encodeURIComponent(chosenPlan) + '&tier=' + planMode + '&states=' + encodeURIComponent(stList) + '&firm=' + encodeURIComponent(document.getElementById('firm').value.trim());
  document.getElementById('portalBtn').href = portalURL;

  // Show success
  var ref = 'FIRM-' + Date.now().toString(36).toUpperCase().slice(-6);
  document.getElementById('sucRef').textContent   = ref;
  document.getElementById('sucEmail').textContent = emailVal;
  document.getElementById('formBody').style.display = 'none';
  document.getElementById('sucScr').classList.add('show');
}

// ===== INIT =====
loadThemePreference();
</script>
</body>
</html>
